[module]
name = "JsonParser"
description = "Minimal JSON parser for Telegram API responses"

[invariants]
parseCallbackData_roundtrip = """
For any valid CID string and choice string,
parseCallbackData (cid ++ "|" ++ choice) == Just (cid, choice)
"""

parseUpdates_empty = """
parseUpdatesJson '{"ok":true,"result":[]}' == Right []
"""

parseUpdates_rejects_false = """
parseUpdatesJson '{"ok":false,...}' returns Left with error description
"""

cid_format = """
callback_data format is "CID|CHOICE" where CID is "agent-timestamp-seq"
"""

[tested_by]
property_tests = "test/Test/JsonParser.idr"

[properties]
prop_parseCallbackData_roundtrip = "Roundtrip: parsing well-formed callback_data works"
prop_parseCallbackData_rejects_no_pipe = "Rejects strings without pipe separator"
prop_parseCallbackData_correct_split = "Correctly splits CID and choice"
prop_parseCallbackData_empty = "Empty string returns Nothing"
prop_parseCallbackData_single_pipe = "Single pipe returns empty parts"
prop_parseUpdates_empty_result = "Parses empty result array"
prop_parseUpdates_rejects_false = "Rejects ok:false responses"
# Skip* function integration tests
prop_skipWs_via_integration = "skipWs handles various whitespace patterns in JSON"
prop_skipNull_via_integration = "skipNull handles null field values"
prop_parseJsonInt_via_integration = "parseJsonInt handles large integers"
prop_skipJsonArray_via_integration = "skipJsonArray handles nested arrays"
prop_skipJsonObject_via_integration = "skipJsonObject handles nested objects"
prop_skipJsonValue_all_types = "skipJsonValue handles all JSON value types"
prop_skipObjectFields_multiple = "skipObjectFields handles multiple fields"
prop_skipArrayElements_multiple = "skipArrayElements handles multiple array elements"
prop_parseCallbackData_multiple_pipes = "parseCallbackData rejects strings with multiple pipes"
